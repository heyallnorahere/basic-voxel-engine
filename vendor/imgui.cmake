set(IMGUI_DIR "${CMAKE_CURRENT_SOURCE_DIR}/imgui")
file(GLOB IMGUI_CORE_SOURCE "${IMGUI_DIR}/*.cpp")
file(GLOB IMGUI_CORE_HEADERS "${IMGUI_DIR}/*.h")
file(GLOB IMGUI_STDLIB "${IMGUI_DIR}/misc/cpp/imgui_stdlib.*")
set(IMGUI_MANIFEST ${IMGUI_CORE_SOURCE} ${IMGUI_CORE_HEADERS} ${IMGUI_STDLIB})
set(IMGUI_INCLUDE_DIRS ${IMGUI_DIR} ${Vulkan_INCLUDE_DIR})
set(IMGUI_LIBRARIES glfw glad ${Vulkan_LIBRARIES})
set(IMGUI_DEFINITIONS IMGUI_IMPL_OPENGL_LOADER_GLAD)
set(ENABLED_IMGUI_BACKENDS glfw opengl3 vulkan)
if(D3D12_FOUND)
    list(APPEND ENABLED_IMGUI_BACKENDS dx12)
    list(APPEND IMGUI_LIBRARIES ${D3D12_LIBRARIES})
    list(APPEND IMGUI_INCLUDE_DIRS ${D3D12_INCLUDE_DIRS})
endif()
foreach(BACKEND_NAME ${ENABLED_IMGUI_BACKENDS})
    file(GLOB BACKEND_SOURCE "${IMGUI_DIR}/backends/imgui_impl_${BACKEND_NAME}.*")
    list(APPEND IMGUI_MANIFEST ${BACKEND_SOURCE})
    set(BACKEND_STRING "${BACKEND_STRING} ${BACKEND_NAME}")
endforeach()
message(STATUS "Enabled Dear ImGui backends:${BACKEND_STRING}")
if(${CMAKE_SIZEOF_VOID_P} EQUAL 4)
    list(APPEND IMGUI_DEFINITIONS "ImTextureID=ImU64")
endif()
add_library(imgui STATIC ${IMGUI_MANIFEST})
target_include_directories(imgui PUBLIC ${IMGUI_INCLUDE_DIRS})
target_link_libraries(imgui PUBLIC ${IMGUI_LIBRARIES})
target_compile_definitions(imgui PUBLIC ${IMGUI_DEFINITIONS})
set_target_properties(imgui PROPERTIES CXX_STANDARD 17)